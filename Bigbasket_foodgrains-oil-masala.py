import pandas as pd
from bs4 import BeautifulSoup as bs
import requests

eanCodeLists = [126903, 30005417, 10000404, 40026603,
                213253, 10000412, 274145, 30010384, 40072494, 30005420, 40021405, 10000423, 10000497, 10000431, 276756, 10000804, 20001215, 40099239, 40000291, 40044729, 40127665, 40026602, 270242, 10000407, 214431, 20000437, 10000414, 30005421, 147491, 20000541, 10000462, 40101871, 10000446, 40075302, 10000803, 283426, 40075896, 40018904, 40018896, 30000229, 10000472, 40112228, 40098408, 40002629, 30000155, 10000519, 70001289, 100647221, 276757, 10000439, 40073431, 148682, 40072468, 30000216, 30010379, 40000625, 10000419, 10000440, 40007926, 274148, 40072479, 40098409, 10000458, 40094998, 40093899, 40093609, 10000801, 200061, 10000500, 30000225, 40092230, 191057, 40151626, 40026597, 236834, 268118, 30002397, 204005, 20002590, 274166, 30010365, 40064889, 100554, 10000417, 265490, 40128963, 10000530, 40067273, 10000478, 20000457, 20000401, 40075470, 124656, 40026607, 40091137, 100079262, 40105916, 268943, 212470, 10000469, 265315, 40075299, 40000624, 40026594, 40072490, 40133697, 40017976, 40072471, 20000539, 40141966, 10000430, 40075125, 20000432, 40071221, 279853, 40072463, 280154, 40019556, 40072458, 40159897, 10000495, 40079750, 40109377, 206778, 40110353, 30000285, 223298, 40114160, 30000285, 223298, 40114160, 10000567, 40168548, 40072477, 40069162, 252423, 40072466, 40017970, 40072474, 10000566, 20000475, 30002287, 268035, 100342218, 40128958, 40125919, 40125922, 40052563, 30000309, 40003518, 40135861, 40161682, 10000488, 20000442, 10000413, 268037, 10000460, 40000209, 40072501, 40109382, 40056581, 40178083, 40093610, 40072497, 271130, 261822, 40067275, 30000120, 10000508, 40093612, 269798, 279823, 10000513, 255499, 10000538, 284340, 274132, 40050537, 248005, 40051741, 241601, 100647222, 30009180, 30010465, 10000562, 40141934, 40072470, 10000470, 255848, 264591, 40076866, 40070758, 30006778, 40077489, 100136199, 40166277, 40072481, 40001421, 274167, 100270868, 40161710, 10000525, 40012925, 40072486, 40072500, 163583, 40026598, 40189431, 301974, 40076173, 40031631, 40159986, 40128832, 274125, 40026100, 40155574, 267995, 40076171,243336,60000721,40003495,40000290,40091826,40131417,40084967,40000750,272765,40128448,40076173,40031631,40159986,40128832,274125,40026100,40155574,267995,40076171,40079748,243336,60000721,40003495,40000290,40091826,40131417,40084967,40000750,272765,40135854]

ProductNameList = []
BrandNameList = []
ProductQntyList = []
ProductPriceList = []
ProductDescList = []

for items in eanCodeLists:
    urlopen = requests.get('https://www.bigbasket.com/pd/'+str(items)).text
    soup = bs(urlopen, 'html.parser')

    ProductInfo = soup.find("h1", {"class": "GrE04"}).text.strip()
    ProductName = ProductInfo.split(' ', 1)[1].split(',')[0]
    ProductNameList.append(ProductName)

    BrandName = soup.find("a", {"class": "_2zLWN _3bj9B rippleEffect"}).text
    BrandNameList.append(BrandName)

    ProductQnty = ProductInfo.split(' ', 1)[1].split(',')[1].strip()
    ProductQntyList.append(ProductQnty)

    ProductPrice = soup.find("td", {"data-qa": "productPrice"}).text.strip()
    ProductPriceList.append(ProductPrice)

    ProductDesc = soup.find("div", {"class": "_26MFu"}).text.strip().split('   ')[-1:]
    ProductDescList.append(ProductDesc)


table_dict = {'Product_Name': ProductNameList, 'Brand_Name': BrandNameList,
              'Product_Qnty': ProductQntyList, 'Product_Price': ProductPriceList, 'Product_Desc': ProductDescList}

df = pd.DataFrame(table_dict)
print(df)

df.to_csv('Bigbasket_foodgrains-oil-masala.csv', index=False)
