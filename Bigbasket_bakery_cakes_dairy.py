from bs4 import BeautifulSoup as bs
import requests

eanCodeLists = [242671, 104860,
                40003162, 100285703, 161899, 40025355, 148715, 279588, 40131633, 40041431, 242673, 40006916, 104759, 244999, 40087526, 40087525, 40037466, 104707, 292620, 100011680, 40087524, 40000519, 242668, 40049915, 266065, 274920, 40025357, 40102603, 258324, 40176629, 312468, 292062, 146775, 277882, 40004532, 40045943, 40005958, 104615, 40135117, 118774, 206701, 40140427, 40012988, 40088412, 175118, 40025356, 40018687, 40037492, 40037465, 40003788, 277878, 30000337, 40012987, 40003159, 228529, 40026295, 259985, 40087523, 40100924, 212533, 30009314, 40009983, 104823, 40037462, 40137716, 30009589, 40121095, 40160490, 40037463, 100204764, 40037459, 40087522, 40100923, 225759, 303262, 40037460, 40075052, 303263, 40184647, 40005941, 40108870, 40124115, 40179114, 40181382, 40181381, 40181380, 40181379, 40170109, 40169941, 40129884, 40188424, 40188422, 40169964, 40169949, 40188425, 40169959, 800000399, 40117870, 40103427, 40159682, 40159681, 40159683, 40103426, 40018937, 40046551, 40120049, 40145969, 30010463, 40094683, 40046550, 40129284, 40103424, 40046548, 40075139, 40046547, 40046546, 279588, 40131633, 40006916, 40100300, 270620, 40003156, 40125755, 312468, 40004532, 40113935, 40135118, 312568, 40096747, 206701, 40003788, 277878, 259992, 40100924, 40121084, 40003160, 40004522, 266070, 40123244, 40020214, 298368, 40003157, 294186, 40122182, 100019887, 40019263, 40076792, 259991, 40069116, 30007714, 40106022, 259990, 40124116, 259993, 40176630, 40075053, 40101055, 40192043, 259978, 40073981, 40113938, 40106023, 40127228, 40121096, 40127642, 40110092, 40037491, 40129901, 40055542, 40087517, 40127643, 40129889, 40087516, 40075624, 40037489, 40055536, 40106026, 40174340, 40106013, 40087518, 40042167, 40172996, 40174341, 40120125, 40120122, 40174342, 40170114, 40129890, 40037477, 40127191, 40106014, 40122989, 40037474, 40181116, 40120119, 40094949, 40181378, 40179113, 40181117, 40129894, 40037493, 40075626, 40106011, 40037478, 40181118, 40172993, 40170116, 40037474, 40181116, 40120119, 40094949, 40181378, 40179113, 40181117, 40129894, 40037493, 40075626, 40106011, 40037478, 40181118, 40172993, 40170116, 303268, 40172999, 40181115, 40055549, 40172995, 40120129, 40075619, 40129897, 40112539, 40120131, 40037475, 40129888, 40091062, 40106016, 40172997, 40129898, 40172998, 40169936, 40169943, 40129896, 800162179, 40111549, 40110135, 40131061, 40037496, 40120126, 40169939, 40169965, 40185414, 40185415, 40120118, 40188421, 40188423, 40075625, 40169944, 40169940, 40129899, 40188427, 40169963, 40129887, 40075627, 40037486, 40055548, 40037494, 40037472, 40106012, 40174339, 40055541, 40004525, 40037487, 40021441, 40094952, 40087514, 40106021, 40087515, 40129893, 40129892, 40037497, 40037476]

ProductNameList =[]
BrandNameList = []
ProductQntyList = []

ProductPriceList = []

ProductDescList =[]

for items in eanCodeLists:
    urlopen = requests.get('https://www.bigbasket.com/pd/'+str(items)).text
    soup = bs(urlopen,'html.parser')

    ProductInfo = soup.find("h1", {"class": "GrE04"}).text.strip()
    ProductName= ProductInfo.split(' ',1)[1].split(',')[0]
    ProductNameList.append(ProductName)

    BrandName = ProductInfo.split(' ', 1)[0]
    BrandNameList.append(BrandName)

    ProductQnty = ProductInfo.split(' ', 1)[1].split(',')[1].strip()
    ProductQntyList.append(ProductQnty)

    ProductPrice = soup.find("td",{"data-qa":"productPrice"}).text.strip()
    ProductPriceList.append(ProductPrice)

    ProductDesc = soup.find("div",{"class":"_26MFu"}).text.strip().split('   ')[-1:]
    ProductDescList.append(ProductDesc)


import pandas as pd

table_dict = {'Product_Name':ProductNameList,'Brand_Name':BrandNameList,'Product_Qnty':ProductQntyList,'Product_Price':ProductPriceList,'Product_Desc':ProductDescList}

df = pd.DataFrame(table_dict)
print(df)

df.to_csv('Bigbasket_bakery_cakes_dairy.csv', index=False)
